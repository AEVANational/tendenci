{% extends "tenents/base.html" %}
{% load file_tags %}
{% load tenent_tags %}
{% load base_filters %}

{% block body %}
{% tenent_nav request.user %}

<div class="t">
    <div class="map-wrap">
        <h1 title="some title">{{ map.name }}</h1>
        <p>{{ map.description }}</p>
        <div class="map-photo">
            <img class="map" src="{{ map|size:'900x' }}" alt="{{ map.name }}" usemap="#mapmap" />
            <map name="mapmap">
            {% for tenent in map.tenent_set.all %}
                <area id="tenent-area-{{ tenent.pk }}" shape="poly" coords="{% for line in tenent.line_set.all %}{{ line.x1 }},{{ line.y1 }}{% if not forloop.last %},{% endif %}{% endfor %}" href="{% url tenents tenent.slug %}" alt="{{ tenent.suite_number }} {{ tenent.name }}" />
            {% endfor %}                
            </map>
        </div>

        {% for tenent in tenents %}
            <div class="tenent-listing" data-tenent-pk="{{ tenent.pk }}"><a href="{% url tenents tenent.slug %}">{{ tenent.suite_number }} {{ tenent.name }}</a></div>
        {% endfor %}

        {% include "tenents/maps/meta.html" %} 
    </div>
</div>
{% endblock body %}

{% block extra_body %}
{{ block.super }}
<script type="text/javascript" src="{{ STATIC_URL }}js/jquery.qtip.min.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}js/jquery.maphilight.js"></script>

<script type="text/javascript">

    // Use the each() method to gain access to each elements attributes
   $('area').each(function() {
        $(this).qtip({
            content: $(this).attr('alt'),
            style: {
                name: 'dark', // Give it the preset dark style
                border: {
                    width: 0, 
                    radius: 4
                },
                tip: true // Apply a tip at the default tooltip corner
            },
            position: {
                corner: {
                    target: 'topMiddle',
                    tooltip: 'bottomMiddle'
                }
            }
        });
   });

    $('.map').maphilight();

    // tenent-listing links to map area
    $('.tenent-listing').mouseover(function(){
        var pk = $(this).attr('data-tenent-pk');
        $('#tenent-area-' + pk).mouseover();
    });

    // tenent-listing links to map area
    $('.tenent-listing').mouseout(function(){
        var pk = $(this).attr('data-tenent-pk');
        $('#tenent-area-' + pk).mouseout();
    });

</script>
{% endblock %}
