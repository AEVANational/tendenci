{% extends "before_and_after/base.html" %}
{% load base_filters %}
{% load base_tags %}
{% load perm_tags %}
{% load before_and_after_tags %}
{% load tagging_tags %}
{% load forms_tags %}

{% block title %}
        {{ bna.title }}&nbsp;&ndash;&nbsp;Before & After
{% endblock %}

{% block meta_keywords %}
    {% nowhitespace %}
        before and after {{ bna.title }}
        {% if bna.tags %}
            {{ bna.tags }}
        {% endif %}
    {% endnowhitespace %}
{% endblock %}

{% block meta_description %}
    {% nowhitespace %}
        {{ bna.title }} before and after
        {{ bna.description|striptags|truncatewords:"50"|safe }}
    {% endnowhitespace %}
{% endblock %}

{% block extra_head %}
    {{ block.super }}
    <style type="text/css">
        {% include "before_and_after/media/css/before_and_after.css" %}
    </style>
    <link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}jcarousel/skins/bna/skin.css" />
    <link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}jcarousel/skins/tango/skin.css" />
{% endblock %}

{% block body %}
<div class="t">
    {% before_and_after_search %}
    <div class="bna-breadcrumbs">
        {% if bna.category %}
            <h1><a href="{% url before_and_after.search %}?category={{ bna.category.pk}}">{{ bna.category.name }}</a></h1>
        {% endif %}
        {% if bna.subcategory %}
            <h2>&raquo; <a href="{% url before_and_after.search %}?category={{ bna.category.pk}}&subcategory={{ bna.subcategory.pk }}">{{ bna.subcategory.name }}</a></h2>
        {% endif %}
    </div>
    <div class="bna-detail">
        <div class="photoset-wrap">
            <div class="photoset-large-border">
                <ul id="featured-carousel" class="jcarousel-skin-bna">
                    {% for photoset in bna.photoset_set.all %}
                        <li>
                        <div class="photoset-large">
                            <img src="{{ photoset.before_photo|thumbnail:'280x500' }}" alt="Before - {{ photoset.description }}">
                            <img src="{{ photoset.after_photo|thumbnail:'280x500' }}" alt="After - {{ photoset.description }}">
                            <p>{{ photoset.description }}</p>
                        </div>
                        </li>
                    {% endfor %}
                </ul>
            </div>
            <div style="clear:both"></div>
        </div>
        <h1>{{ bna.title }}</h1>
        <div class="desc">
            
            <b>Description</b>
            <p>{{ bna.description|safe }}</p>
        </div>
        {% if bna.photoset_set.all %}
            <div class="other-photosets-wrap">
                <h2>More Photos</h2>
                <div class="other-photosets-border">
                    <ul id="more-photos-carousel" class="jcarousel-skin-tango">
                    {% for set in bna.photoset_set.all %}
                        <li>
                            <a id="set-{{ forloop.counter }}" class="set-link" href="#featured-carousel">
                                <div class="photoset-small">
                                    <img src="{{ set.before_photo|thumbnail:'80x80' }}">
                                    <img src="{{ set.after_photo|thumbnail:'80x80' }}">
                                </div>
                            </a>
                        </li>
                    {% endfor %}
                    </ul>
                </div>
            </div>
        {% endif %}
        <div>
        {% if prev %}
            <a href="{% url before_and_after.detail prev.pk %}">Prev</a>
        {% endif %}
        {% if next %}
            <a href="{% url before_and_after.detail next.pk %}">Next</a>
        {% endif %}
        </div>
    </div>
    <div class="bna-embed-form">
        {% embed_form embed_form %}
    </div>
</div>
{% endblock body %}

{% block extra_body %}
    {{ block.super }}
    <script type="text/javascript" src="{{ STATIC_URL }}js/jquery-1.4.2.min.js"></script>
    <script src="{{ STATIC_URL }}jcarousel/lib/jquery.jcarousel.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        jQuery(document).ready(function() {
            jQuery('#featured-carousel').jcarousel({
                scroll: 1,
                visible: 1,
            });
            jQuery('#more-photos-carousel').jcarousel({
                visible: 4,
            });
            jQuery('.set-link').click(function(event) {
                number = parseInt(event.currentTarget.id.split('-')[1]);
                jQuery('#featured-carousel').jcarousel('scroll', number, true);
            });
        });
    </script>
{% endblock extra_body %}
