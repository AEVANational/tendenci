{% extends "reports/base.html" %}
{% load i18n %}

{% block content %}
<h1>{% trans "Active Members YTD" %}</h1>
<div class="mems-wrap stat-table">
{% blocktrans with year=year %}
    Currently showing data for {{ year }}.
{% endblocktrans %}
<form class="search-form" action="{% url reports-active-members-ytd %}" method="get">
<label for="id_year">{% trans "Year" %}:</label><select name="year" id="id_year" onchange="this.form.submit();">
<option value="" selected="selected">-----------</option>
{% for year in years %}
    <option value="{{ year }}">{{ year }}</option>
{% endfor %}
</select>
</form>
<table>
    <tr>
        <th>{% trans "Members" %}</th>
        {% for month in months %}
            <th>{{ month.name }}</th>
        {% endfor %}
        <th>{% trans "Total" %}</th>
    </tr>
    <tr>
        <td>{% trans "New" %}</td>
        {% for month in months %}
            <td>{{ month.new_mems }}</td>
        {% endfor %}
        <td>{{ total_new }}
    </tr>
    <tr>
        <td>{% trans "Renewing" %}</td>
        {% for month in months %}
            <td>{{ month.renew_mems }}</td>
        {% endfor %}
        <td>{{ total_renew }}
    </tr>
    <tr>
        <td>{% trans "Total Active" %}</td>
        {% for month in months %}
            <td>{{ month.total_active }}</td>
        {% endfor %}
        <td></td>
    </tr>        
</table>
</div>

<div id="chart_div">
  <script type="text/javascript" src="https://www.google.com/jsapi"></script>
  <script type="text/javascript">
    google.load("visualization", "1", {packages:["corechart"]});
    google.setOnLoadCallback(drawChart);
    function drawChart() {
      var data = new google.visualization.DataTable();
      data.addColumn('string', 'Months');
      data.addColumn('number', 'New');
      data.addColumn('number', 'Renewing');
      {% if include_total %}
      data.addColumn('number', 'Total Active');
      {% endif %}
      data.addRows([
        {% for  month in months %}
          ['{{ month.name }}', {{ month.new_mems }},
          {{ month.renew_mems }}{% if include_total %}, {{ month.total_active }}{% endif %}],
        {% endfor %}
      ]);
      var options = {
        width: 1000, height: 500,
        hAxis: {title: 'Month'},
        vAxis: {title: '# Members'}
      };

      var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
      chart.draw(data, options);
    }
  </script>
</div>
<div>
{% if include_total %}
<a href="{% url reports-active-members-ytd %}">Exclude Total Active from Chart</a>
{% else %}
<a href="{% url reports-active-members-ytd%}?include_total=on">Include Total Active to Chart</a>
{% endif %} 
 </div>
 
{% endblock content %}