{% load i18n %}
{% load staticfiles %}
{% load avatar_tags %}
{% load megamenu_tags %}


<li class="dropdown">
    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
        {# NOTE: Notice repeated DISPLAY_NAME context. This is to avoid newline/whitespace between the <img> and the text #}
        {% if USER_IS_SUPERUSER %}
            <img class="nav-icon" src="{% static 'famfamfam/icons/user_orange.png' %}">{{ DISPLAY_NAME }} <span class="caret"></span>
        {% elif USER_IS_MEMBER_EXPIRED %}
            <img class="nav-icon" src="{% static 'famfamfam/icons/user_red.png' %}">{{ DISPLAY_NAME }} <span class="caret"></span>
        {% elif USER_IS_MEMBER_ACTIVE %}
            <img class="nav-icon" src="{% static 'famfamfam/icons/user_go.png' %}">{{ DISPLAY_NAME }} <span class="caret"></span>
        {% else %}
            <img class="nav-icon" src="{% static 'famfamfam/icons/user.png' %}">{{ DISPLAY_NAME }} <span class="caret"></span>
        {% endif %}
    </a>

    {% get_profile_dropdown_column_size as col_size %}
    <ul class="dropdown-menu profile-dropdown" role="menu">
        <li>
            <div class="yamm-content custom-yamm-content content-dropdown">
                <div class="row">
                    <div class="col-sm-{{ col_size }} content-dropdown-col">
                        <ul class="list-unstyled">
                            <div class="profile-icon">
                                {% avatar user 128 %}
                            </div>
                            <a class="update-avatar-link" href="{% url 'profile.change_avatar' user.pk %}">{% trans 'Update Photo' %}</a>
                        </ul>
                    </div>

                    <div class="col-sm-{{ col_size }} content-dropdown-col">
                        <ul class="list-unstyled">
                            <li><span class="content-head"><a href="{% url 'profile.index' %}">{% trans 'Welcome' %} {{ DISPLAY_NAME }}</a></span></li>

                            <li class="content-item">
                                <span class="app-name">
                                    <a href="{% url 'profile.index' %}">
                                        {% if USER_IS_SUPERUSER %}
                                            <img class="nav-icon" src="{% static 'famfamfam/icons/user_orange.png' %}">{% trans 'Profile' %}
                                        {% elif USER_IS_MEMBER_EXPIRED %}
                                            <img class="nav-icon" src="{% static 'famfamfam/icons/user_red.png' %}">{% trans 'Profile' %}
                                        {% elif USER_IS_MEMBER_ACTIVE %}
                                            <img class="nav-icon" src="{% static 'famfamfam/icons/user_go.png' %}">{% trans 'Profile' %}
                                        {% else %}
                                            <img class="nav-icon" src="{% static 'famfamfam/icons/user.png' %}">{% trans 'Profile' %}
                                        {% endif %}
                                    </a>
                                </span>
                            </li>

                            {% if MODULE_MEMBERSHIPS_ENABLED %}
                                <li class="content-item">
                                    <span class="app-name"><a href="{% url 'profile.search' %}?member_only=on"><img class="nav-icon" src="{% static 'famfamfam/icons/arrow_join.png' %}"/>{% trans 'Membership' %}</a></span>
                                </li>
                            {% endif %}

                            {% if MODULE_GROUPS_ENABLED %}
                                <li class="content-item">
                                    <span class="app-name"><a href="{% url 'groups' %}"><img class="nav-icon" src="{% static 'famfamfam/icons/group.png' %}"/>{% trans 'Groups' %}</a></span>
                                </li>
                            {% endif %}

                            {% if MODULE_COMMITTEES_ENABLED %}
                                <li class="content-item">
                                    <span class="app-name"><a href="{% url 'committees.search' %}"><img class="nav-icon" src="{% static 'famfamfam/icons/group_gear.png' %}"/>{% trans 'Committees' %}</a></span>
                                </li>
                            {% endif %}
                        </ul>
                    </div>

                    {% if USER_IS_SUPERUSER or USER_IS_MEMBER %}
                        <div class="col-sm-{{ col_size }} content-dropdown-col">
                            <ul class="list-unstyled">
                                <li><span class="content-head text-content-head">{% trans 'Activities' %}</span></li>

                                <li class="content-item">
                                    <span class="app-name"><a href="{% url 'event.myevents' %}"><img class="nav-icon" src="{% static 'famfamfam/icons/calendar_view_day.png' %}"/>{% trans 'Events' %}</a></span>
                                </li>

                                {% if MODULE_DONATIONS_ENABLED %}
                                    <li class="content-item">
                                        <span class="app-name"><a href="{% url 'donation.add' %}"><img class="nav-icon" src="{% static 'famfamfam/icons/money.png' %}"/>{% trans 'Donate' %}</a></span>
                                    </li>
                                {% endif %}
                            </ul>
                        </div>
                    {% endif %}

                    {% if USER_IS_SUPERUSER %}
                        <div class="col-sm-{{ col_size }} content-dropdown-col">
                            <ul class="list-unstyled admin-col">
                                <li><span class="content-head text-content-head">{% trans 'Administrator' %}</span></li>
                                {% comment %}
                                <li class="content-item">
                                    <span class="app-name">
                                        <a href="#">
                                            <img class="nav-icon" src="{% static 'famfamfam/icons/folder_user.png' %}"/>{% trans 'View as...' %}
                                        </a>
                                    </span>
                                </li>
                                {% endcomment %}
                                <li class="content-item">
                                    <span class="app-name">
                                        <a href="{% url 'settings.index' 'site' 'global' %}">
                                            <img class="nav-icon" src="{% static 'famfamfam/icons/wrench.png' %}"/>{% trans 'Site Settings' %}
                                        </a>
                                    </span>
                                </li>
                                <li class="content-item">
                                    <span class="app-name">
                                        <a href="{% url 'settings' %}">
                                            <img class="nav-icon" src="{% static 'famfamfam/icons/wrench.png' %}"/>{% trans 'Full Settings' %}
                                        </a>
                                    </span>
                                </li>
                            </ul>
                        </div>
                    {% endif %}
                </div>
            </div>
        </li>
    </ul>
</li>
