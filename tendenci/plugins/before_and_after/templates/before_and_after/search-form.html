<div class="bna-search">
    <form class="search-form" action="{% url before_and_after.search %}" method="get">
    {# form.category #}
    {# form.subcategory #}
    {# form.q #}
      <select name="category" class="category-list">
  <option value="">All Categories ({{ categories|length }})</option>
  {% for cat in categories %}
    {% if request.GET.category == cat.pk|slugify or bna.category.pk|slugify == cat.pk|slugify %}
    <option selected value="{{ cat.pk }}">{{ cat.name }}</option>
    {% else %}
    <option value="{{ cat.pk }}">{{ cat.name }}</option>
    {% endif %}
  {% endfor %}
  </select>

  <select name="subcategory">
  <option value="">All Subcategories ({{ subcategories|length }})</option>
  {% for subcat in subcategories %}
    {% if request.GET.subcategory == subcat.pk|slugify or bna.subcategory.pk|slugify == subcat.pk|slugify %}
    <option selected value="{{ subcat.pk }}">{{ subcat.name }}</option>
    {% else %}
    <option value="{{ subcat.pk }}">{{ subcat.name }}</option>
    {% endif %}
  {% endfor %}
  </select>
    {% if SITE_GLOBAL_SEARCHINDEX %}
    <input type="text" name="q" value="{{ request.GET.q|striptags }}" />
    {% endif %}
    
    <input type="submit" value="Search" />
    </form>
</div>